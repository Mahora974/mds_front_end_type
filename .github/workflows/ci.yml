name: CI

on: [push]

jobs:
    deploy:
        if: github.ref == 'refs/heads/main'
        runs-on: ubuntu-latest
        steps:
          - uses: actions/checkout@v2
          - name: Push to server
            uses: appleboy/ssh-action@master
            with:
              host: ${{ secrets.SERVER_IP }}
              username: ${{ secrets.SERVER_USERNAME }}
              password: ${{ secrets.SERVER_PASSWORD }}
              script: |
                cd /var/mds_front_end_type
                git pull
                npm i
                npm run build
                pm2 restart nuxt-app